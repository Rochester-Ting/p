import{d as e,u as a,h as t,t as l,r as n,c as o,w as i,o as r,j as s,a as c,l as u,g as d,v as p,i as v,x as m,y as f,z as w,A as h,q as y,B as k,C as g,D as j,F as C,m as b,p as x,k as P,E as _}from"./vendor.6e217547.js";import{u as I,d as V,g as S,s as q}from"./projectApi.0ec6fdeb.js";import{E as M,A as D,g as T}from"./uuid.4ba239b0.js";const G=()=>{const e=localStorage.getItem("allProjectGroup");return e?Promise.resolve(JSON.parse(e)):Promise.resolve([])},L=(e=[])=>{setTimeout((()=>(localStorage.setItem("allProjectGroup",JSON.stringify(e)),Promise.resolve())),800)},N=s("div",null,"提示",-1),U=u(" 取消 "),A=u(" 确定 ");var B=e({props:{showModal:{type:Boolean,required:!0},inputVal:{type:String,required:!0},placeholder:{type:String,required:!0}},emits:["cancelClick","confirmClick","update:inputVal"],setup(e,{emit:u}){const d=e,p=a(),v=t("");l((()=>{v.value=d.inputVal}));const m=()=>{console.log("cancelClick"),u("cancelClick")},f=()=>{v.value?(u("update:inputVal",v.value),setTimeout((()=>{u("confirmClick")}),300)):p.error("请输入内容")};return(e,a)=>{const t=n("n-input"),l=n("n-button"),u=n("n-modal");return r(),o(u,{show:d.showModal,"show-icon":!1,preset:"dialog",title:"Dialog"},{header:i((()=>[N])),action:i((()=>[s("div",null,[c(l,{class:"mr-4",onClick:m},{default:i((()=>[U])),_:1}),c(l,{type:"error",onClick:f},{default:i((()=>[A])),_:1})])])),default:i((()=>[s("div",null,[c(t,{value:v.value,"onUpdate:value":a[0]||(a[0]=e=>v.value=e),placeholder:d.placeholder},null,8,["value","placeholder"])])])),_:1},8,["show"])}}});const E={class:"\n      h-44\n      w-80\n      bg-white\n      flex\n      mb-5\n      mr-5\n      cursor-pointer\n      rounded\n      overflow-hidden\n    "},J={class:"flex-auto"},O={class:"p-3 underline flex items-center flex justify-between"};var z=e({props:{id:{type:String,required:!0,default:""},name:{type:String,required:!0,default:""},parentId:{type:String,required:!0,default:""}},emits:["updateProjectDetail"],setup(e,{emit:u}){const y=e,k=d(),g=t("");l((()=>{g.value=y.name}));const j=a(),C=p(),b=t(!1),x=[{label:"重命名",key:"edit"},{label:"删除",key:"delete"}],P=()=>{k.push({name:"ProjectDetail",query:{id:y.id,parentId:y.parentId}})},_=async()=>{b.value=!1;const e=w({id:"",name:""});e.id=y.id,e.name=g.value;try{await I(y.parentId,e),u("updateProjectDetail"),j.success("修改成功!")}catch(a){j.error("修改失败")}},S=async e=>{"edit"===e&&(b.value=!0),"delete"===e&&C.error({title:"提示",content:"是否删除?",positiveText:"确定",showIcon:!1,negativeText:"取消",onPositiveClick:()=>{(async()=>{try{await V(y.parentId,{id:y.id,name:y.name}),u("updateProjectDetail"),j.success("删除成功!")}catch(e){j.error("删除失败")}})()}})};return(e,a)=>{const t=n("n-image"),l=n("n-icon"),u=n("n-dropdown");return r(),v("div",E,[c(t,{onClick:P,class:"flex-shrink-0",width:"150",src:"https://07akioni.oss-cn-beijing.aliyuncs.com/07akioni.jpeg"}),s("div",J,[s("div",O,[s("span",{class:"truncate w-28",onClick:P},m(y.name),1),c(u,{trigger:"click",onSelect:S,options:x,"show-arrow":!0},{default:i((()=>[c(l,{class:"ml-3 project-aside-item-icon"},{default:i((()=>[c(h(M))])),_:1})])),_:1})])]),b.value?(r(),o(B,{key:0,showModal:b.value,inputVal:g.value,"onUpdate:inputVal":a[0]||(a[0]=e=>g.value=e),placeholder:"请输入项目名字",onCancelClick:a[1]||(a[1]=e=>b.value=!1),onConfirmClick:_},null,8,["showModal","inputVal"])):f("v-if",!0)])}}}),F=e({setup(e){const a=y().matched;return(e,t)=>{const l=n("n-breadcrumb-item"),s=n("n-breadcrumb");return r(),o(s,null,{default:i((()=>[(r(!0),v(C,null,k(h(a),((e,a)=>g((r(),o(l,{key:a},{default:i((()=>[u(m(e.meta.name),1)])),_:2},1536)),[[j,"Home"!==e.name&&"Project"!==e.name]]))),128))])),_:1})}}});const H={class:"\n      w-full\n      h-16\n      border-b border-solid border-gray-100\n      flex\n      items-center\n      px-10\n      justify-between\n    "},K=u(" 新建项目 ");var Q=e({props:{projectGroupList:{type:Array,required:!0}},emits:["createNewProjectClick"],setup(e,{emit:a}){const t=e,l=()=>{a("createNewProjectClick")};return(e,a)=>{const o=n("n-icon"),s=n("n-button");return r(),v("div",H,[c(F),c(s,{onClick:l,disabled:0===t.projectGroupList.length},{icon:i((()=>[c(o,null,{default:i((()=>[c(h(D))])),_:1})])),default:i((()=>[K])),_:1},8,["disabled"])])}}});x("data-v-3333af8f");const R={class:"project-content flex"},W={class:"\n          flex flex-col\n          items-center\n          w-60\n          bg-gray-100\n          overflow-auto\n          flex-shrink-0\n        "},X=s("div",{class:"mt-4"},"项目组管理",-1),Y=["onClick"],Z=u(" 新建项目组 "),$={class:"\n          flex-auto\n          h-auto\n          p-5\n          flex flex-wrap\n          overflow-auto\n          bg-gray-200\n          pl-10\n          content-start\n        "};P();var ee=e({setup(e){const l=a(),d=p(),w=t(!1),y=t(!1),g=t([]),j=t([]),x=t({id:"",name:""}),P=t({id:"",name:""}),I=t({id:"",name:""}),V=t(!1),N=[{label:"重命名",key:"edit"},{label:"删除",key:"delete"}],U=()=>{console.log("?????"),y.value=!1},A=async()=>{U(),P.value.id=T(),j.value.push(P.value),console.log("projectList.value",j.value),await q(x.value.id,j.value),P.value={id:"",name:""},await H()},E=()=>{y.value=!0},J=async()=>{const e={id:T(),name:"新建项目组"+(g.value.length+1)};g.value.push(e),await L(g.value),x.value=e},O=async e=>{try{await(async e=>{const a=await G();if(a.length>0){const t=a.findIndex((a=>e.id===a.id));return t>=0?(a.splice(t,1),L(a),Promise.resolve()):Promise.reject()}return Promise.reject()})(e),l.success("删除成功"),await K()}catch(a){l.error("删除失败")}},F=async e=>{try{w.value=!1,"edit"===e&&(await(async e=>{const a=await G();if(a.length>0){const t=a.findIndex((a=>e.id===a.id));return t>=0?(a[t]=e,L(a),Promise.resolve()):Promise.reject()}return Promise.reject()})(I.value),l.success("修改成功")),await K()}catch(a){l.error("修改失败")}},H=async()=>{j.value=await S(x.value.id),console.log("current.value.id",x.value.id,j.value)},K=()=>{V.value=!0,setTimeout((async()=>{g.value=await G(),g.value.length>0&&(x.value=g.value[0],await H()),V.value=!1}),1e3)};return b((()=>{K()})),(e,a)=>{const t=n("n-icon"),l=n("n-dropdown"),p=n("n-button"),b=n("n-spin");return r(),o(b,{show:V.value},{default:i((()=>[c(Q,{projectGroupList:g.value,onCreateNewProjectClick:E},null,8,["projectGroupList"]),s("div",R,[s("div",W,[X,(r(!0),v(C,null,k(g.value,((e,a)=>(r(),v("div",{class:_(["project-aside-item",e.id===x.value.id?"active":""]),key:a,onClick:a=>(e=>{x.value=e,H()})(e)},[u(m(e.name||"新建项目组"+(a+1))+" ",1),c(l,{trigger:"click",onSelect:a=>(async(e,a)=>{I.value=a,"edit"===e&&(w.value=!0),"delete"===e&&d.error({title:"提示",content:"是否删除?",positiveText:"确定",showIcon:!1,negativeText:"取消",onPositiveClick:()=>{O(a)}})})(a,e),options:N,"show-arrow":!0},{default:i((()=>[c(t,{class:"project-aside-item-icon"},{default:i((()=>[c(h(M))])),_:1})])),_:2},1032,["onSelect"])],10,Y)))),128)),c(p,{class:"mt-4 w-56",onClick:J},{icon:i((()=>[c(t,null,{default:i((()=>[c(h(D))])),_:1})])),default:i((()=>[Z])),_:1})]),s("div",$,[(r(!0),v(C,null,k(j.value,((e,a)=>(r(),o(z,{key:a,parentId:x.value.id,id:e.id,name:e.name,onUpdateProjectDetail:H},null,8,["parentId","id","name"])))),128))])]),w.value?(r(),o(B,{key:0,showModal:w.value,inputVal:I.value.name,"onUpdate:inputVal":a[0]||(a[0]=e=>I.value.name=e),placeholder:"请输入新的名字",onCancelClick:a[1]||(a[1]=e=>F("cancel")),onConfirmClick:a[2]||(a[2]=e=>F("edit"))},null,8,["showModal","inputVal"])):f("v-if",!0),y.value?(r(),o(B,{key:1,showModal:y.value,inputVal:P.value.name,"onUpdate:inputVal":a[3]||(a[3]=e=>P.value.name=e),placeholder:"请输入项目名字",onCancelClick:U,onConfirmClick:A},null,8,["showModal","inputVal"])):f("v-if",!0)])),_:1},8,["show"])}}});ee.__scopeId="data-v-3333af8f";export{ee as default};
