import{d as e,j as l,h as a,t,y as s,s as o,r as u,k as n,b as d,w as r,u as i,c,B as v,p,l as f,m,o as h,T as b,G as g,D as y,H as w,q as x,A as j,x as _,I,E as S,J as k,K as U,L as q,i as C}from"./vendor.882c7a74.js";import{V,E as P,A as J}from"./vue-draggable-next.esm-bundler.776c20e5.js";import{_ as N,C as O}from"./ProjectEditModal.vue_vue&type=script&setup=true&lang.05f4e946.js";import{g as L}from"./uuid.a7ba8b83.js";const D=e=>{const l=localStorage.getItem("shootList");if(l){return JSON.parse(l).filter((l=>l.projectId!==e))||[]}return[]},z=e=>{const l=localStorage.getItem("shootList");if(l){const a=JSON.parse(l).filter((l=>l.projectId===e));if(a)return Promise.resolve(a)}return Promise.resolve([])},B=async e=>{if(e.id&&e.projectId){const l=await z(e.projectId),a=l.findIndex((l=>e.id===l.id&&l.projectId===e.projectId));-1===a?l.push(e):l[a]=e;const t=D(e.projectId);return localStorage.setItem("shootList",JSON.stringify(t.concat(l))),Promise.resolve()}return Promise.reject()};p("data-v-052684fc");const M={class:"\n      flex flex-col\n      items-center\n      w-60\n      bg-gray-100\n      overflow-auto\n      flex-shrink-0\n    "},T=f("div",{class:"mt-4"},"分镜头列表",-1),E=["onClick"],A=x(" 新建分镜头 ");m();var H=e({emits:["updateSelectedSL"],setup(e,{emit:p}){const f=l([]),m=a(),_=t(),I=s(),S=l(!1),k=l({id:"",name:"",projectId:""}),U=[{label:"重命名",key:"edit"},{label:"删除",key:"delete"}],q=async e=>{S.value=!1,"edit"===e&&await B(k.value),await F()},C=async()=>{const e={id:L(),projectId:_.query.id+"",name:"第"+(f.value.length+1)+"场"+L().substr(Math.floor(10*Math.random()+1),2)};try{await B(e),m.success("保存成功"),await F()}catch(l){m.error("保存失败")}},O=async()=>{try{await(async(e,l)=>{const a=D(l);return localStorage.setItem("shootList",JSON.stringify(a.concat(e))),Promise.resolve()})(f.value,_.query.id+""),await F()}catch(e){m.error("调整顺序失败")}},H=e=>{k.value=e,p("updateSelectedSL",e)},G=async e=>{try{await(async e=>{if(e.id&&e.projectId){const l=await z(e.projectId),a=l.findIndex((l=>e.id===l.id));if(a>-1){l.splice(a,1);const t=D(e.projectId);return localStorage.setItem("shootList",JSON.stringify(t.concat(l))),Promise.resolve()}return Promise.reject()}return Promise.reject()})(e),m.success("删除成功"),await F()}catch(l){m.error("删除失败")}},K=async e=>{"edit"===e&&(S.value=!0),"delete"===e&&I.error({title:"提示",content:"是否删除?",positiveText:"确定",showIcon:!1,negativeText:"取消",onPositiveClick:()=>{G(k.value)}})},F=async()=>{try{f.value=await z(_.query.id+""),f.value.length>0&&H(f.value[0])}catch(e){m.error("获取分镜头列表失败")}};return o((()=>{F()})),(e,l)=>{const a=u("n-icon"),t=u("n-dropdown"),s=u("n-button");return h(),n("div",M,[T,d(i(V),{modelValue:f.value,"onUpdate:modelValue":l[0]||(l[0]=e=>f.value=e),onChange:O},{default:r((()=>[d(b,null,{default:r((()=>[(h(!0),n(g,null,y(f.value,((e,l)=>(h(),n("div",{class:w(["sl-aside-item",e.id===k.value.id?"active":""]),key:l,onClick:l=>H(e)},[x(j(e.name||"新建分镜头"+(l+1))+" ",1),d(t,{trigger:"click",onSelect:K,options:U,"show-arrow":!0},{default:r((()=>[d(a,{class:"sl-aside-item-icon"},{default:r((()=>[d(i(P))])),_:1})])),_:1})],10,E)))),128))])),_:1})])),_:1},8,["modelValue"]),d(s,{class:"mt-4 w-56",onClick:C},{icon:r((()=>[d(a,null,{default:r((()=>[d(i(J))])),_:1})])),default:r((()=>[A])),_:1}),S.value?(h(),c(N,{key:0,showModal:S.value,inputVal:k.value.name,"onUpdate:inputVal":l[1]||(l[1]=e=>k.value.name=e),placeholder:"请输入新的名字",onCancelClick:l[2]||(l[2]=e=>q("cancel")),onConfirmClick:l[3]||(l[3]=e=>q("edit"))},null,8,["showModal","inputVal"])):v("v-if",!0)])}}});H.__scopeId="data-v-052684fc";const G=e=>{const l=localStorage.getItem("shootDetail");if(l){const a=JSON.parse(l);return Promise.resolve(a.filter((l=>e===l.shootId))||[])}return Promise.resolve([])},K=e=>{const l=localStorage.getItem("shootDetail")||JSON.stringify([]);return JSON.parse(l).filter((l=>e!==l.shootId))},F=[{label:"超远景",value:"超远景"},{label:"远景",value:"远景"},{label:"全景",value:"全景"},{label:"中景",value:"中景"},{label:"近景",value:"近景"},{label:"特写",value:"特写"},{label:"大特写",value:"大特写"}],Q=[{label:"固定",value:"固定"},{label:"推动",value:"推动"},{label:"拉动",value:"拉动"},{label:"摇动",value:"摇动"},{label:"甩动",value:"甩动"},{label:"移动",value:"移动"},{label:"跟拍",value:"跟拍"},{label:"上升",value:"上升"},{label:"下降",value:"下降"}],R=[{label:"低角度",value:"低角度"},{label:"高角度",value:"高角度"},{label:"俯视角度",value:"俯视角度"},{label:"视线高度",value:"视线高度"},{label:"地面高度",value:"地面高度"}],W=[{label:"向左倾斜",value:"向左倾斜"},{label:"向右倾斜",value:"向右倾斜"}],X=[{label:"单人镜头",value:"单人镜头"},{label:"双人镜头",value:"双人镜头"},{label:"多人镜头",value:"多人镜头"},{label:"过肩镜头",value:"过肩镜头"},{label:"主观镜头",value:"主观镜头"}];p("data-v-7e9fd0bd");const Y={class:"p-10 pt-5 flex-auto w-full"},Z={class:"text-3xl pb-5"},$=U('<div class="flex items-center h-10 bg-gray-50 text-gray-500 text-sm" data-v-7e9fd0bd><span class="w-20 pl-2" data-v-7e9fd0bd>场次</span><span class="w-20 pl-2" data-v-7e9fd0bd>镜号</span><span class="flex-auto pl-2" data-v-7e9fd0bd>内容描述</span><span class="w-32 pl-4" data-v-7e9fd0bd>景别</span><span class="w-52 pl-4" data-v-7e9fd0bd>镜头类型</span><span class="w-40 pl-4" data-v-7e9fd0bd>机位运动</span><span class="w-40 pl-2" data-v-7e9fd0bd>备注</span><span class="w-32 pl-4" data-v-7e9fd0bd>操作</span></div>',1),ee=["value"],le=["onUpdate:modelValue"],ae=["onUpdate:modelValue"],te={class:"w-32 pl-4"},se={class:"flex items-center cursor-pointer"},oe={class:"w-52 pl-4"},ue={class:"flex items-center cursor-pointer"},ne={class:"w-80 h-80 bg-white flex flex-wrap"},de={class:"w-1/2 h-1/2 flex-col"},re=f("div",{class:"font-bold"},"镜头高度",-1),ie={class:"w-1/2 h-1/2"},ce=f("div",{class:"font-bold"},"德式倾斜",-1),ve={class:"w-1/2 h-1/2"},pe=f("div",{class:"font-bold"},"画面/构图",-1),fe={class:"w-1/2 h-1/2",style:{position:"relative"}},me=x("重置"),he={class:"w-40 pl-4"},be={class:"flex items-center cursor-pointer"},ge=["onUpdate:modelValue"],ye=["onClick"],we={class:"flex items-center h-10 text-gray-500 text-sm text-gray-500"},xe=["value"],je={class:"w-32 pl-4"},_e={class:"flex items-center cursor-pointer"},Ie={class:"w-52 pl-4"},Se={class:"flex items-center cursor-pointer"},ke={class:"w-80 h-80 bg-white flex flex-wrap"},Ue={class:"w-1/2 h-1/2 flex-col"},qe=f("div",{class:"font-bold"},"镜头高度",-1),Ce={class:"w-1/2 h-1/2"},Ve=f("div",{class:"font-bold"},"德式倾斜",-1),Pe={class:"w-1/2 h-1/2"},Je=f("div",{class:"font-bold"},"画面/构图",-1),Ne={class:"w-1/2 h-1/2",style:{position:"relative"}},Oe=x("重置"),Le={class:"w-40 pl-4"},De={class:"flex items-center cursor-pointer"};m();var ze=e({props:{name:{type:String,required:!0},shootId:{type:String,required:!0}},setup(e){const t=e,s=l(!1),o=a(),v=l([]),p=l({id:"",shootId:"",cc:"",jh:"",nrms:"",jb:"",jwyd:"",bz:"",jtlx:"",jtgd:"",hmgt:"",dsqx:""});_((()=>{q((()=>{w(t.shootId)}))})),I((()=>t.shootId),(()=>{w(t.shootId)}));const m=async()=>{try{await(async e=>{const l=K(e[0].shootId).concat(e);return localStorage.setItem("shootDetail",JSON.stringify(l)),Promise.resolve()})(v.value),await G(t.shootId)}catch(e){o.error("保存失败")}},w=async e=>{s.value=!0,v.value=await G(e),setTimeout((()=>{s.value=!1}),800)},U=async()=>{try{if(p.value.id=L(),p.value.shootId=t.shootId,!(p.value.id&&p.value.shootId&&p.value.jh&&p.value.nrms&&p.value.jb&&p.value.jwyd))return void o.error("请填写完整分镜头");await(async e=>{const l=localStorage.getItem("shootDetail")||JSON.stringify([]),a=JSON.parse(l);return a.push(e),localStorage.setItem("shootDetail",JSON.stringify(a)),Promise.resolve()})(p.value),p.value={id:"",shootId:"",cc:"",jh:"",nrms:"",jb:"",jwyd:"",bz:"",jtlx:"",jtgd:"",dsqx:"",hmgt:""},await w(t.shootId)}catch(e){o.error("保存失败")}},C=async e=>{try{await(async e=>{const l=localStorage.getItem("shootDetail")||JSON.stringify([]),a=JSON.parse(l),t=a.findIndex((l=>l.id===e.id));return-1===t?Promise.reject():(a.splice(t,1),localStorage.setItem("shootDetail",JSON.stringify(a)),Promise.resolve())})(e),o.success("删除成功"),await w(t.shootId)}catch(l){o.error("删除失败")}},P=e=>{e.hmgt="",e.dsqx="",e.jtgd="",m()},J=()=>{m()};return(e,l)=>{const a=u("n-icon"),s=u("n-popselect"),o=u("n-radio"),w=u("n-space"),_=u("n-radio-group"),I=u("n-button"),q=u("n-popover");return h(),n("div",Y,[f("div",Z,j(t.name),1),f("div",null,[$,d(i(V),{modelValue:v.value,"onUpdate:modelValue":l[0]||(l[0]=e=>v.value=e),onChange:J},{default:r((()=>[d(b,null,{default:r((()=>[(h(!0),n(g,null,y(v.value,((e,l)=>(h(),n("div",{class:"\n              flex\n              items-center\n              w-full\n              h-10\n              text-gray-500 text-sm text-gray-500\n            ",key:l},[f("input",{class:"input w-20 h-10",value:t.name,type:"text",disabled:!0,onBlur:m,placeholder:"场次"},null,40,ee),S(f("input",{class:"input w-20 h-10","onUpdate:modelValue":l=>e.jh=l,type:"text",onBlur:m,placeholder:"镜号"},null,40,le),[[k,e.jh]]),S(f("input",{class:"input flex-auto","onUpdate:modelValue":l=>e.nrms=l,type:"text",onBlur:m,placeholder:"请输入内容描述"},null,40,ae),[[k,e.nrms]]),f("div",te,[d(s,{options:i(F),value:e.jb,"onUpdate:value":[l=>e.jb=l,m],trigger:"click",scrollable:""},{default:r((()=>[f("div",se,[x(j(e.jb||"景别")+" ",1),d(a,null,{default:r((()=>[d(i(O))])),_:1})])])),_:2},1032,["options","value","onUpdate:value"])]),f("div",oe,[d(q,{trigger:"click"},{trigger:r((()=>[f("div",ue,[x(j(e.jtgd||e.hmgt||e.dsqx?(e.jtgd?e.jtgd:"")+"/"+(e.dsqx?e.dsqx:"")+"/"+(e.hmgt?e.hmgt:""):"镜头类型")+" ",1),d(a,null,{default:r((()=>[d(i(O))])),_:1})])])),default:r((()=>[f("div",ne,[f("div",de,[re,d(_,{class:"ml-2",value:e.jtgd,"onUpdate:value":[l=>e.jtgd=l,m]},{default:r((()=>[d(w,null,{default:r((()=>[(h(!0),n(g,null,y(i(R),((e,l)=>(h(),c(o,{key:l,value:e.value},{default:r((()=>[x(j(e.label),1)])),_:2},1032,["value"])))),128))])),_:2},1024)])),_:2},1032,["value","onUpdate:value"])]),f("div",ie,[ce,d(_,{class:"ml-2",value:e.dsqx,"onUpdate:value":[l=>e.dsqx=l,m]},{default:r((()=>[d(w,null,{default:r((()=>[(h(!0),n(g,null,y(i(W),((e,l)=>(h(),c(o,{key:l,value:e.value},{default:r((()=>[x(j(e.label),1)])),_:2},1032,["value"])))),128))])),_:2},1024)])),_:2},1032,["value","onUpdate:value"])]),f("div",ve,[pe,d(_,{class:"ml-2",value:e.hmgt,"onUpdate:value":[l=>e.hmgt=l,m]},{default:r((()=>[d(w,null,{default:r((()=>[(h(!0),n(g,null,y(i(X),((e,l)=>(h(),c(o,{key:l,value:e.value},{default:r((()=>[x(j(e.label),1)])),_:2},1032,["value"])))),128))])),_:2},1024)])),_:2},1032,["value","onUpdate:value"])]),f("div",fe,[d(I,{class:"absolute bottom-2 left-2",onClick:l=>P(e)},{default:r((()=>[me])),_:2},1032,["onClick"])])])])),_:2},1024)]),f("div",he,[d(s,{options:i(Q),value:e.jwyd,"onUpdate:value":[l=>e.jwyd=l,m],trigger:"click",scrollable:""},{default:r((()=>[f("div",be,[x(j(e.jwyd||"机位运动")+" ",1),d(a,null,{default:r((()=>[d(i(O))])),_:1})])])),_:2},1032,["options","value","onUpdate:value"])]),S(f("input",{class:"input w-40","onUpdate:modelValue":l=>e.bz=l,type:"text",onBlur:m,placeholder:"请输入内容描述"},null,40,ge),[[k,e.bz]]),f("span",{class:"w-32 pl-4 cursor-pointer underline text-red-700",onClick:l=>C(e)}," 删除 ",8,ye)])))),128))])),_:1})])),_:1},8,["modelValue"]),f("div",we,[f("input",{class:"input w-20 h-10",disabled:!0,value:t.name,type:"text",placeholder:"场次"},null,8,xe),S(f("input",{class:"input w-20 h-10","onUpdate:modelValue":l[1]||(l[1]=e=>p.value.jh=e),type:"text",placeholder:"镜号"},null,512),[[k,p.value.jh]]),S(f("input",{class:"input flex-auto","onUpdate:modelValue":l[2]||(l[2]=e=>p.value.nrms=e),type:"text",placeholder:"请输入内容描述"},null,512),[[k,p.value.nrms]]),f("div",je,[d(s,{options:i(F),value:p.value.jb,"onUpdate:value":l[3]||(l[3]=e=>p.value.jb=e),trigger:"click",scrollable:""},{default:r((()=>[f("div",_e,[x(j(p.value.jb||"景别")+" ",1),d(a,null,{default:r((()=>[d(i(O))])),_:1})])])),_:1},8,["options","value"])]),f("div",Ie,[d(q,{trigger:"click"},{trigger:r((()=>[f("div",Se,[x(j(p.value.jtgd||p.value.hmgt||p.value.dsqx?(p.value.jtgd?p.value.jtgd:"")+"/"+(p.value.dsqx?p.value.dsqx:"")+"/"+(p.value.hmgt?p.value.hmgt:""):"镜头类型")+" ",1),d(a,null,{default:r((()=>[d(i(O))])),_:1})])])),default:r((()=>[f("div",ke,[f("div",Ue,[qe,d(_,{class:"ml-2",value:p.value.jtgd,"onUpdate:value":l[4]||(l[4]=e=>p.value.jtgd=e)},{default:r((()=>[d(w,null,{default:r((()=>[(h(!0),n(g,null,y(i(R),((e,l)=>(h(),c(o,{key:l,value:e.value},{default:r((()=>[x(j(e.label),1)])),_:2},1032,["value"])))),128))])),_:1})])),_:1},8,["value"])]),f("div",Ce,[Ve,d(_,{class:"ml-2",value:p.value.dsqx,"onUpdate:value":l[5]||(l[5]=e=>p.value.dsqx=e)},{default:r((()=>[d(w,null,{default:r((()=>[(h(!0),n(g,null,y(i(W),((e,l)=>(h(),c(o,{key:l,value:e.value},{default:r((()=>[x(j(e.label),1)])),_:2},1032,["value"])))),128))])),_:1})])),_:1},8,["value"])]),f("div",Pe,[Je,d(_,{class:"ml-2",value:p.value.hmgt,"onUpdate:value":l[6]||(l[6]=e=>p.value.hmgt=e)},{default:r((()=>[d(w,null,{default:r((()=>[(h(!0),n(g,null,y(i(X),((e,l)=>(h(),c(o,{key:l,value:e.value},{default:r((()=>[x(j(e.label),1)])),_:2},1032,["value"])))),128))])),_:1})])),_:1},8,["value"])]),f("div",Ne,[d(I,{class:"absolute bottom-2 left-2",onClick:l[7]||(l[7]=e=>P(p.value))},{default:r((()=>[Oe])),_:1})])])])),_:1})]),f("div",Le,[d(s,{options:i(Q),value:p.value.jwyd,"onUpdate:value":l[8]||(l[8]=e=>p.value.jwyd=e),trigger:"click",scrollable:""},{default:r((()=>[f("div",De,[x(j(p.value.jwyd||"机位运动")+" ",1),d(a,null,{default:r((()=>[d(i(O))])),_:1})])])),_:1},8,["options","value"])]),S(f("input",{class:"input w-40","onUpdate:modelValue":l[9]||(l[9]=e=>p.value.bz=e),type:"text",placeholder:"请输入内容描述"},null,512),[[k,p.value.bz]]),f("div",{class:"w-32 pl-4 cursor-pointer underline text-green-700",onClick:U}," 添加 ")])])])}}});ze.__scopeId="data-v-7e9fd0bd",p("data-v-2524e697");const Be={class:"\n        w-full\n        h-16\n        border-b border-solid border-gray-100\n        flex\n        items-center\n        px-10\n        justify-between\n      "},Me=x(" 所有项目 "),Te=x(" 分镜头列表 "),Ee=x("打印预览"),Ae=x("分享"),He={class:"sl-content flex"};m();var Ge=e({setup(e){const a=t(),s=C(),o=l(!1),n=l({id:"",name:"",projectId:""}),p=e=>{n.value=e},m=()=>{s.push({name:"ProjectHome"})},b=()=>{s.go(-1)};return(e,l)=>{const t=u("n-breadcrumb-item"),s=u("n-breadcrumb"),g=u("n-button"),y=u("n-space"),w=u("n-spin");return h(),c(w,{show:o.value},{default:r((()=>[f("div",Be,[d(s,null,{default:r((()=>[d(t,{onClick:m},{default:r((()=>[Me])),_:1}),d(t,{onClick:b},{default:r((()=>[x(j(i(a).query.name),1)])),_:1}),d(t,null,{default:r((()=>[Te])),_:1})])),_:1}),d(y,null,{default:r((()=>[d(g,{type:"primary"},{default:r((()=>[Ee])),_:1}),d(g,{type:"primary"},{default:r((()=>[Ae])),_:1})])),_:1})]),f("div",He,[d(H,{onUpdateSelectedSL:p}),n.value.id?(h(),c(ze,{key:0,shootId:n.value.id,name:n.value.name},null,8,["shootId","name"])):v("v-if",!0)])])),_:1},8,["show"])}}});Ge.__scopeId="data-v-2524e697";export{Ge as default};
