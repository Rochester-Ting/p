import{d as e,h as a,j as t,x as l,r as n,c as o,w as r,o as i,l as s,b as c,q as u,i as d,y as p,k as v,u as m,A as f,B as w,C as h,t as y,D as k,E as g,F as C,G as j,s as b,p as x,m as P,H as _}from"./vendor.882c7a74.js";import{c as I,u as S,d as V,g as q,s as M}from"./cover.a765defc.js";import{E as D,A as G}from"./EllipsisHorizontalSharp.17c10d59.js";import{g as T}from"./uuid.a7ba8b83.js";const L=()=>{const e=localStorage.getItem("allProjectGroup");return e?Promise.resolve(JSON.parse(e)):Promise.resolve([])},N=(e=[])=>{setTimeout((()=>(localStorage.setItem("allProjectGroup",JSON.stringify(e)),Promise.resolve())),800)},U=s("div",null,"提示",-1),A=u(" 取消 "),E=u(" 确定 ");var H=e({props:{showModal:{type:Boolean,required:!0},inputVal:{type:String,required:!0},placeholder:{type:String,required:!0}},emits:["cancelClick","confirmClick","update:inputVal"],setup(e,{emit:u}){const d=e,p=a(),v=t("");l((()=>{v.value=d.inputVal}));const m=()=>{console.log("cancelClick"),u("cancelClick")},f=()=>{v.value?(u("update:inputVal",v.value),setTimeout((()=>{u("confirmClick")}),300)):p.error("请输入内容")};return(e,a)=>{const t=n("n-input"),l=n("n-button"),u=n("n-modal");return i(),o(u,{show:d.showModal,"show-icon":!1,preset:"dialog",title:"Dialog"},{header:r((()=>[U])),action:r((()=>[s("div",null,[c(l,{class:"mr-4",onClick:m},{default:r((()=>[A])),_:1}),c(l,{type:"error",onClick:f},{default:r((()=>[E])),_:1})])])),default:r((()=>[s("div",null,[c(t,{value:v.value,"onUpdate:value":a[0]||(a[0]=e=>v.value=e),placeholder:d.placeholder},null,8,["value","placeholder"])])])),_:1},8,["show"])}}});const B={class:"\n      h-44\n      w-80\n      bg-white\n      flex\n      mb-5\n      mr-5\n      cursor-pointer\n      rounded\n      overflow-hidden\n    "},J={class:"flex-auto"},O={class:"p-3 underline flex items-center flex justify-between"};var z=e({props:{id:{type:String,required:!0,default:""},name:{type:String,required:!0,default:""},parentId:{type:String,required:!0,default:""}},emits:["updateProjectDetail"],setup(e,{emit:u}){const y=e,k=d(),g=t("");l((()=>{g.value=y.name}));const C=a(),j=p(),b=t(!1),x=[{label:"重命名",key:"edit"},{label:"删除",key:"delete"}],P=()=>{k.push({name:"ProjectDetail",query:{id:y.id,parentId:y.parentId}})},_=async()=>{b.value=!1;const e=h({id:"",name:""});e.id=y.id,e.name=g.value;try{await S(y.parentId,e),u("updateProjectDetail"),C.success("修改成功!")}catch(a){C.error("修改失败")}},q=async e=>{"edit"===e&&(b.value=!0),"delete"===e&&j.error({title:"提示",content:"是否删除?",positiveText:"确定",showIcon:!1,negativeText:"取消",onPositiveClick:()=>{(async()=>{try{await V(y.parentId,{id:y.id,name:y.name}),u("updateProjectDetail"),C.success("删除成功!")}catch(e){C.error("删除失败")}})()}})};return(e,a)=>{const t=n("n-image"),l=n("n-icon"),u=n("n-dropdown");return i(),v("div",B,[c(t,{onClick:P,class:"flex-shrink-0",width:"150",src:m(I)},null,8,["src"]),s("div",J,[s("div",O,[s("span",{class:"truncate w-28",onClick:P},f(y.name),1),c(u,{trigger:"click",onSelect:q,options:x,"show-arrow":!0},{default:r((()=>[c(l,{class:"ml-3 project-aside-item-icon"},{default:r((()=>[c(m(D))])),_:1})])),_:1})])]),b.value?(i(),o(H,{key:0,showModal:b.value,inputVal:g.value,"onUpdate:inputVal":a[0]||(a[0]=e=>g.value=e),placeholder:"请输入项目名字",onCancelClick:a[1]||(a[1]=e=>b.value=!1),onConfirmClick:_},null,8,["showModal","inputVal"])):w("v-if",!0)])}}}),F=e({setup(e){const a=y().matched;return(e,t)=>{const l=n("n-breadcrumb-item"),s=n("n-breadcrumb");return i(),o(s,null,{default:r((()=>[(i(!0),v(j,null,k(m(a),((e,a)=>g((i(),o(l,{key:a},{default:r((()=>[u(f(e.meta.name),1)])),_:2},1536)),[[C,"Home"!==e.name&&"Project"!==e.name]]))),128))])),_:1})}}});const K={class:"\n      w-full\n      h-16\n      border-b border-solid border-gray-100\n      flex\n      items-center\n      px-10\n      justify-between\n    "},Q=u(" 新建项目 ");var R=e({props:{projectGroupList:{type:Array,required:!0}},emits:["createNewProjectClick"],setup(e,{emit:a}){const t=e,l=()=>{a("createNewProjectClick")};return(e,a)=>{const o=n("n-icon"),s=n("n-button");return i(),v("div",K,[c(F),c(s,{onClick:l,disabled:0===t.projectGroupList.length},{icon:r((()=>[c(o,null,{default:r((()=>[c(m(G))])),_:1})])),default:r((()=>[Q])),_:1},8,["disabled"])])}}});x("data-v-3333af8f");const W={class:"project-content flex"},X={class:"\n          flex flex-col\n          items-center\n          w-60\n          bg-gray-100\n          overflow-auto\n          flex-shrink-0\n        "},Y=s("div",{class:"mt-4"},"项目组管理",-1),Z=["onClick"],$=u(" 新建项目组 "),ee={class:"\n          flex-auto\n          h-auto\n          p-5\n          flex flex-wrap\n          overflow-auto\n          bg-gray-200\n          pl-10\n          content-start\n        "};P();var ae=e({setup(e){const l=a(),d=p(),h=t(!1),y=t(!1),g=t([]),C=t([]),x=t({id:"",name:""}),P=t({id:"",name:""}),I=t({id:"",name:""}),S=t(!1),V=[{label:"重命名",key:"edit"},{label:"删除",key:"delete"}],U=()=>{console.log("?????"),y.value=!1},A=async()=>{U(),P.value.id=T(),C.value.push(P.value),console.log("projectList.value",C.value),await M(x.value.id,C.value),P.value={id:"",name:""},await F()},E=()=>{y.value=!0},B=async()=>{const e={id:T(),name:"新建项目组"+(g.value.length+1)};g.value.push(e),await N(g.value),x.value=e},J=async e=>{try{await(async e=>{const a=await L();if(a.length>0){const t=a.findIndex((a=>e.id===a.id));return t>=0?(a.splice(t,1),N(a),Promise.resolve()):Promise.reject()}return Promise.reject()})(e),l.success("删除成功"),await K()}catch(a){l.error("删除失败")}},O=async e=>{try{h.value=!1,"edit"===e&&(await(async e=>{const a=await L();if(a.length>0){const t=a.findIndex((a=>e.id===a.id));return t>=0?(a[t]=e,N(a),Promise.resolve()):Promise.reject()}return Promise.reject()})(I.value),l.success("修改成功")),await K()}catch(a){l.error("修改失败")}},F=async()=>{C.value=await q(x.value.id),console.log("current.value.id",x.value.id,C.value)},K=()=>{S.value=!0,setTimeout((async()=>{g.value=await L(),g.value.length>0&&(x.value=g.value[0],await F()),S.value=!1}),1e3)};return b((()=>{K()})),(e,a)=>{const t=n("n-icon"),l=n("n-dropdown"),p=n("n-button"),b=n("n-spin");return i(),o(b,{show:S.value},{default:r((()=>[c(R,{projectGroupList:g.value,onCreateNewProjectClick:E},null,8,["projectGroupList"]),s("div",W,[s("div",X,[Y,(i(!0),v(j,null,k(g.value,((e,a)=>(i(),v("div",{class:_(["project-aside-item",e.id===x.value.id?"active":""]),key:a,onClick:a=>(e=>{x.value=e,F()})(e)},[u(f(e.name||"新建项目组"+(a+1))+" ",1),c(l,{trigger:"click",onSelect:a=>(async(e,a)=>{I.value=a,"edit"===e&&(h.value=!0),"delete"===e&&d.error({title:"提示",content:"是否删除?",positiveText:"确定",showIcon:!1,negativeText:"取消",onPositiveClick:()=>{J(a)}})})(a,e),options:V,"show-arrow":!0},{default:r((()=>[c(t,{class:"project-aside-item-icon"},{default:r((()=>[c(m(D))])),_:1})])),_:2},1032,["onSelect"])],10,Z)))),128)),c(p,{class:"mt-4 w-56",onClick:B},{icon:r((()=>[c(t,null,{default:r((()=>[c(m(G))])),_:1})])),default:r((()=>[$])),_:1})]),s("div",ee,[(i(!0),v(j,null,k(C.value,((e,a)=>(i(),o(z,{key:a,parentId:x.value.id,id:e.id,name:e.name,onUpdateProjectDetail:F},null,8,["parentId","id","name"])))),128))])]),h.value?(i(),o(H,{key:0,showModal:h.value,inputVal:I.value.name,"onUpdate:inputVal":a[0]||(a[0]=e=>I.value.name=e),placeholder:"请输入新的名字",onCancelClick:a[1]||(a[1]=e=>O("cancel")),onConfirmClick:a[2]||(a[2]=e=>O("edit"))},null,8,["showModal","inputVal"])):w("v-if",!0),y.value?(i(),o(H,{key:1,showModal:y.value,inputVal:P.value.name,"onUpdate:inputVal":a[3]||(a[3]=e=>P.value.name=e),placeholder:"请输入项目名字",onCancelClick:U,onConfirmClick:A},null,8,["showModal","inputVal"])):w("v-if",!0)])),_:1},8,["show"])}}});ae.__scopeId="data-v-3333af8f";export{ae as default};
